!function(t,e){"use strict";if(!t)throw new Error("'Klass' isn't included.");if(!e)throw new Error("'jQuery' isn't included.");window.Vuw=t.create("Vuw",{_ver:"1.0.0",$self:!1,$template:!1,_initialize:function(t){var e={name:"",selector:"",createTemplate:function(){},onReady:function(){},onChangeState:function(){},render:function(){},renderComplete:function(){}};return e=this.isObject(t)?t:{},!e.name&&(e.name=String((new Date).valueOf())),this.isReady=!1,this.state={},this._onReadyCallbacks=[],e.onReady&&(this.onReady(e.onReady),delete e.onReady),this._onChangeStateCallbacks=[],e.onChangeState&&(this.onChangeState(e.onChangeState),delete e.onChangeState),this.setProp(e)},getProp:function(t){return this.hasOwnProperty(t)?this[t]:void 0},setProp:function(t,e,r){return t?this.isString(t)?this._setProp(t,e,!!r):this.isObject(t)&&(r=e===!0,t.onReady&&(this.onReady(t.onReady),delete t.onReady),t.onChangeState&&(this.onChangeState(t.onChangeState),delete t.onChangeState),Object.keys(t).forEach(function(e){this._setProp(e,t[e],r)},this)):csl.warn((this.name||"Vuw")+".setProp() ... arguments[0] is required."),this},_setProp:function(t,e,r){return this.hasOwnProperty(t)&&!r?csl.warn((this.name||"Vuw")+".setProp() ... '"+t+"' is already defined."):this[t]=e,this},_templateAreaPropTo:"_tmp",getTemplateArea:function(t){var r;return!this[this._templateAreaPropTo]&&(this[this._templateAreaPropTo]={}),this[this._templateAreaPropTo]._$templateArea||(this[this._templateAreaPropTo]._$templateArea=e("<div/>").addClass("vuw-template-area").hide().appendTo(document.body)),r=this[this._templateAreaPropTo]._$templateArea,t===!1?r.get(0):r},getReady:function(){var r,t=e.Deferred();return this.isReady?(csl.log("** "+this.name+".getReady() is already executed."),t.resolve()):this.isGettingReady?(csl.log("** "+this.name+" is getting ready now..."),t.resolve()):(this.isGettingReady=!0,!!this.selector&&function(){var t;this.isString(this.selector)?t=e(this.selector):this.isFunction(this.selector)&&(t=this.selector.call(this)),t&&t instanceof e&&t.length&&(void 0!==t.attr("data-vuw-template")?(this.$template=t,t=e("<var/>").attr("data-vuw",this.name).insertBefore(this.$template),this.$self=t):(this.$self=t,e.data(this.$self.get(0),"vuw",this)))}.call(this),this.isFunction(this.createTemplate)&&function(){var t;t=this.createTemplate.call(this),t&&t instanceof e&&t.length&&(this.$template=t)}.call(this),!!this.$template&&this.$template.appendTo(this.getTemplateArea()),r=this._onReadyCallbacks.map(function(t){return t.call(this,this.$self,this.$template)},this),e.when.apply(e,r).then(function(){this.isReady=!0,delete this.isGettingReady,t.resolve.apply(t,Array.prototype.slice.call(arguments,0))}.bind(this),t.reject.bind(t))),t.promise()},onReady:function(t){return this.isFunction(t)&&(this.isReady?(csl.log.gray(this.name,"isReady to execute."),t.call(this,this.$self,this.$template)):this._onReadyCallbacks.push(t)),this},getState:function(t){return this.isReady?t&&this.isString(t)?this.state[t]:this.state:(csl.warn(this.name+".getState() ... getReady() didn't execute yet."),!1)},setState:function(t,r){var n=e.Deferred(),i=!1;return this.isReady?this.isChangingState?(csl.log(this.name+" is changing state...",[t,r]),n.reject()):t?this.isString(t)?(this.state[t]=r,i=!0):this.isObject(t)?(this.state=t,i=!0):(csl.warn(this.name+".setState() ... arguments error."),n.reject()):(csl.warn(this.name+".setState() ... arguments[0] is required."),n.reject()):(csl.warn(this.name+".setState() ... getReady() didn't execute yet."),n.reject()),i&&this.changeState().then(function(){!!this.$self&&this.$self.trigger("changeState"),n.resolve.apply(n,Array.prototype.slice.call(arguments,0))}.bind(this),n.reject.bind(n)),n.promise()},changeState:function(){var r,t=e.Deferred();return this.isChangingState=!0,r=this._onChangeStateCallbacks.map(function(t){return t.call(this,this.state)},this),e.when.apply(e,r).then(function(){var e=this._execRender(Array.prototype.slice.call(arguments,0));this.isChangingState=!1,t.resolve(e)}.bind(this),function(){this.isChangingState=!1,t.reject.apply(t,Array.prototype.slice(arguments,0))}),t.promise()},onChangeState:function(t){return this.isFunction(t)&&this._onChangeStateCallbacks.push(t),this},getCloneFromTemplate:function(){var t=!1;return this.$template&&(t=this.$template.clone().attr({id:null,"data-vuw-template":null}).removeClass("template")),t},_execRender:function(){var r,t=Array.prototype.slice.call(arguments,0);return t.unshift(this.state),t.unshift(this.getCloneFromTemplate()),r=this.render.apply(this,t),this.$self&&r&&(r instanceof e||!this.isElement(r)&&!this.isString(r)||(r=e(r)),r instanceof e&&r.length&&(this.$self.replaceWith(r),this.$self=r,e.data(this.$self.get(0),"vuw",this),this.isFunction(this.renderComplete)&&this.renderComplete(r))),r},render:function(){},renderComplete:function(){}}),window.Vuw.useVuwer=function(){return this.vuwer=t.new_("Vuw",{name:"vuwer",selector:function(){return e(window)},_vuwMap:{},_childKlass:"VuwerComponent",_getComponentsReady:function(){var n,r=e.Deferred();return n=Object.keys(this._vuwMap).map(function(e){var r=this._vuwMap[e];return r instanceof t(this._childKlass)&&!r.isReady?r.getReady():void 0},this),e.when.apply(e,n).then(function(){var t=Object.keys(this._vuwMap),e={};Array.prototype.slice.call(arguments,0).forEach(function(r,n){Array.isArray(r)&&(r=r.filter(function(t){return!!t}),!r.length&&(r=void 0)),void 0===r||(e[t[n]]=r)},this),this.isReady=!0,r.resolve(e)}.bind(this),r.reject.bind(r)),r.promise()},onReady:function(t){return this.$window=t,this._getComponentsReady()},add:function(e,r,n){var i;if(this.isFunction(e)&&e instanceof t(this._childKlass))i=e;else{if(!this.isString(e))return csl.warn("vuwer.add() ... arguments[0] is must be string.",typeof e),this;if(e in this._vuwMap&&!n)return csl.warn("vuwer.add() ... '"+e+"' is already defined."),this;this.isObject(r)||(r={}),Object.assign(r,{name:e}),r.vuwType&&this.isString(r.vuwType)?(e="Vuw"+r.vuwType.slice(0,1).toUpperCase()+r.vuwType.slice(1),this.isFunction(t(e))||(e=this._childKlass,r.vuwType="component")):(e=this._childKlass,r.vuwType="component"),i=t.new_(e,r)}return this._vuwMap[i.name]=i,this},get:function(t){return this.isString(t)?this._vuwMap[t]||!1:(csl.warn("vuwer.get() ... arguments[0] is must be string.",typeof t),!1)},remove:function(t){var e;return this.isString(t)?(e=this.get(t))?(e.$self&&e.$self.length&&e.$self.remove(),e.$template&&e.$template.length&&e.$template.remove(),delete this._vuwMap[t],this):this:(csl.warn("vuwer.remove() ... arguments[0] is must be string.",typeof t),this)},appendKlass:function(e,r,n){if(!this.isString(e))return csl.warn("vuwer.appendKlass() ... arguments[0] is must be string.",typeof e),this;if(t(e))return csl.warn("vuwer.appendKlass() ... '"+e+"' is already defined."),this;if(this.isString(n)){if(!this.isFunction(t(n)))return csl.warn("vuwer.appendKlass() ... '"+n+"' is undefined."),this}else{if(!this.isFunction(t(this._childKlass)))return csl.warn("vuwer.appendKlass() ... '"+this._childKlass+"' is undefined."),this;n=this._childKlass}return t.create(e).extends_(n,r),this}}),this.vuwer.appendKlass("VuwerComponent",{_vuwer:this.vuwer,_templateAreaPropTo:"_vuwer",_initialize:function(e){return t("VuwerComponent").parent._initialize.call(this,e)},getVuwer:function(){return this._vuwer},getOther:function(t){return this.getVuwer().get(t)},getCloneFromTemplate:function(){var r=this,n=t("Vuw").prototype.getCloneFromTemplate.call(this);return n&&n.find("[data-vuw]").each(function(){var s,t=e(this),n=t.data("vuw"),i=r.getOther(n);i&&(i.setProp("$self",t,!0),s=r.getState(n),r.isObject(s)&&i.setState(s))}),n}},"Vuw"),this.vuwer.appendKlass("VuwContainer",{_initialize:function(e){return t("VuwContainer").parent._initialize.call(this,e)?(this.onReady(this.getVuwer()._getComponentsReady.bind(this)),this):!1},_vuwMap:{},_childKlass:"",add:function(){var n=Array.prototype.slice.call(arguments,0);return this.getVuwer().add.apply(this,n),this},get:function(t){return this.getVuwer().get.call(this,t)}},"VuwerComponent"),this.vuwer.appendKlass("VuwFade",{_initialize:function(r){return t("VuwFade").parent._initialize.call(this,r)?(this.onReady(function(t){var e;t&&(["absolute","fixed"].indexOf(t.css("position"))>=0&&(this.orgHeight=t.height()),t.attr("data-visible","0"),e=parseFloat(t.css("transition-duration")),isNaN(e)?t.css("transition-duration",String(this.delay/1e3)+"s"):this.delay+=1e3*e)}),this.onChangeState(function(t){var r;return this.$self?(r="1"===this.$self.attr("data-visible")?!0:!1,(r===t.visible?0:1)?e.Deferred(function(e){return!!this.orgHeight&&this.$self.css("height",this.orgHeight),this.$self.attr("data-visible",""),t.visible?(this.$self.attr("data-visible","1"),setTimeout(function(){!!this.orgHeight&&this.$self.css("height",""),e.resolve()}.bind(this),this.delay)):setTimeout(function(){this.$self.attr("data-visible","0"),!!this.orgHeight&&this.$self.css("height",""),e.resolve()}.bind(this),this.delay),e.promise()}.bind(this)):!1):(csl.log.red("  "+this.name+".onChangeState","$self is false."),!1)}),this):!1},delay:0},"VuwerComponent"),this.vuwer}}(window.Klass,window.jQuery||window.$);