!function(t,e){"use strict";t.vuwer=e(t.Klass,t.jQuery||t.$)}(this,function(t,e){"use strict";if(!t)throw new Error("'Klass' isn't included.");if(!e)throw new Error("'jQuery' isn't included.");return t.create("Vuw",{_ver:"1.0.3",$self:!1,$template:!1,_initialize:function(t){var e={name:"",selector:"",createTemplate:function(){},onReady:function(){},onReadyFirst:function(){},onReadyLast:function(){},onChangeState:function(){},render:function(){},renderComplete:function(){}};return e=this.isObject(t)?t:{},!e.name&&(e.name=String((new Date).valueOf())),this.isReady=!1,this.state={},this._onReadyCallbacks=[],this._onChangeStateCallbacks=[],this._stateBooked={},this._stateBookedCBs=[],this.setProp(e)},getProp:function(t){return this.hasOwnProperty(t)?this[t]:void 0},setProp:function(t,e,i){return t?this.isString(t)?this._setProp(t,e,!!i):this.isObject(t)&&(i=e===!0,t.onReady&&(this.onReady(t.onReady),delete t.onReady),t.onChangeState&&(this.onChangeState(t.onChangeState),delete t.onChangeState),Object.keys(t).forEach(function(e){this._setProp(e,t[e],i)},this)):csl.warn((this.name||"Vuw")+".setProp() ... arguments[0] is required."),this},_setProp:function(t,e,i){return this.hasOwnProperty(t)&&!i?csl.warn((this.name||"Vuw")+".setProp() ... '"+t+"' is already defined."):this[t]=e,this},_templateAreaPropTo:"_tmp",getTemplateArea:function(i){return t("Vuw")._$templateArea||(t("Vuw")._$templateArea=e("<div/>").addClass("vuw-template-area").hide().appendTo(document.body)),i===!1?t("Vuw")._$templateArea.get(0):t("Vuw")._$templateArea},getReady:function(){var t=e.Deferred();return this.isReady?(csl.log("** "+this.name+".getReady() is already executed."),t.resolve()):this.isGettingReady?(csl.log("** "+this.name+" is getting ready now..."),t.resolve()):(this.isGettingReady=!0,!!this.selector&&function(){var t;this.isString(this.selector)?t=e(this.selector):this.isFunction(this.selector)&&(t=this.selector.call(this)),t&&t instanceof e&&t.length&&(void 0!==t.attr("data-vuw-template")?(this.$template=t,t=e("<var/>").attr("data-vuw",this.name).insertBefore(this.$template),this.$self=t):(this.$self=t,e.data(this.$self.get(0),"vuw",this)))}.call(this),this.isFunction(this.createTemplate)&&function(){var t;t=this.createTemplate.call(this),t&&t instanceof e&&t.length&&(this.$template=t)}.call(this),this.$template&&(!!this.$template.attr("id")&&this.$template.attr({"data-id":this.$template.attr("id"),id:null}),this.$template.appendTo(this.getTemplateArea())),this.isReady=!0,e.when(this.isFunction(this.onReadyFirst)&&this.onReadyFirst(this.$self,this.$template)).then(function(){var t=this._onReadyCallbacks.map(function(t){return t.call(this,this.$self,this.$template)},this);return e.when.apply(e,t)}.bind(this)).then(function(){var t=this.getAsArray(arguments),i=e.Deferred();return e.when(this.isFunction(this.onReadyLast)?this.onReadyLast(this.$self,this.$template):void 0).then(function(){arguments.length&&void 0!==arguments[0]&&(t=t.concat(this.getAsArray(arguments))),i.resolve.apply(i,t)}.bind(this),i.reject.bind(i)),i.promise()}.bind(this)).then(function(){delete this.isGettingReady,t.resolve.apply(t,this.getAsArray(arguments))}.bind(this),t.reject.bind(t))),t.promise()},onReady:function(t){return this.isFunction(t)&&(this.isReady?(csl.log.gray(this.name+"... isReady to execute."),t.call(this,this.$self,this.$template)):this._onReadyCallbacks.push(t)),this},getState:function(t){return this.isReady?t&&this.isString(t)?this.state[t]:this.state:(csl.warn(this.name+".getState() ... getReady() didn't execute yet."),!1)},setState:function(t,i){var r,s=e.Deferred(),n=!1,a=!1;return this.isReady?t?(r=Object.assign({},this.state),this.isString(t)?this.isChangingState?(this._bookState(function(e){return e[t]=i,e}({}),s.resolve.bind(s)),a=!0):(r[t]=i,n=!0):this.isObject(t)?this.isChangingState?(this._bookState(t,s.resolve.bind(s)),a=!0):(r=t,n=!0):csl.warn(this.name+".setState() ... arguments error.")):csl.warn(this.name+".setState() ... arguments[0] is required."):csl.warn(this.name+".setState() ... getReady() didn't execute yet."),n?this.changeState(r).then(function(){s.resolve.apply(s,this.getAsArray(arguments)),!!this.$self&&this.$self.trigger("changeState"),this._setStateBooked()}.bind(this),s.reject.bind(s)):a||s.reject(),s.promise()},_bookState:function(t,e){return Object.assign(this._stateBooked,t),this._stateBookedCBs.push(e),this},_setStateBooked:function(){var t;return Object.keys(this._stateBooked).length?(t=Object.assign({},this._stateBooked),this._stateBooked={},this.setState(t).then(function(){csl.log.gray(this.name+" ... set booked state",Object.assign({CB_count:this._stateBookedCBs.length},t));var e,i=this._stateBookedCBs.length;if(i){for(e=0;i>e;e++)this._stateBookedCBs[e]();this._stateBookedCBs=[]}}.bind(this))):!1},changeState:function(t){var s,i=e.Deferred();if(!this.isObject(t))throw new TypeError("state must be object.");return this.isChangingState=!0,s=this._onChangeStateCallbacks.map(function(e){return e.call(this,t)},this),e.when.apply(e,s).then(function(){var e;this.state=t,e=this._execRender(this.getAsArray(arguments)),this.isChangingState=!1,i.resolve(e)}.bind(this),function(){this.isChangingState=!1,i.reject.apply(i,this.getAsArray(arguments))}),i.promise()},onChangeState:function(t){return this.isFunction(t)&&this._onChangeStateCallbacks.push(t),this},getCloneFromTemplate:function(){var t=!1;return this.$template&&(t=this.$template.clone().attr({id:this.$template.attr("data-id")||null,"data-id":null,"data-vuw-template":null}).removeClass("template")),t},_execRender:function(){var i,t=this.getAsArray(arguments);return t.unshift(this.state),t.unshift(this.getCloneFromTemplate()),i=this.render.apply(this,t),this.$self&&i&&(i instanceof e||!this.isElement(i)&&!this.isString(i)||(i=e(i)),i instanceof e&&i.length&&(this.$self.replaceWith(i),this.$self=i,e.data(this.$self.get(0),"vuw",this),this.isFunction(this.renderComplete)&&this.renderComplete(i))),i},render:function(){},renderComplete:function(){}}),t("Vuw").getVersion=function(){return this.prototype._ver},function(){var i=t.new_("Vuw",{name:"vuwer",selector:function(){return e(window)},_vuwMap:{},childKlass:"VuwerComponent",_getComponentsReady:function(){var s,i=e.Deferred();return s=Object.keys(this._vuwMap).map(function(e){var i=this._vuwMap[e];return i instanceof t(this.childKlass)&&!i.isReady?i.getReady():void 0},this),e.when.apply(e,s).then(function(){var t=Object.keys(this._vuwMap),e={};this.getAsArray(arguments).forEach(function(i,s){Array.isArray(i)&&(i=i.filter(function(t){return!(!t||this.isObject(t)&&!Object.keys(t).length||this.isArray(t)&&!t.length)},this),!i.length&&(i=void 0)),void 0===i||(e[t[s]]=i)},this),i.resolve(e)}.bind(this),i.reject.bind(i)),i.promise()},onReady:function(t){return this.$window=t,this._getComponentsReady()},add:function(e,i,s,n){var a,r;return"boolean"==typeof s&&(n=s),this.isString(e)?e in this._vuwMap&&!n?(csl.warn(this.name+".add() ... '"+e+"' is already defined."),this):(this.isObject(i)?i instanceof t(this.childKlass)&&(a=i):i={},a?a.container=this:(Object.assign(i,{name:e,container:this}),i.vuwType&&this.isString(i.vuwType)?(r="Vuw"+i.vuwType.slice(0,1).toUpperCase()+i.vuwType.slice(1),this.isFunction(t(r))||(r=this.childKlass,i.vuwType="component")):(r=this.childKlass,i.vuwType="component"),a=t.new_(r,i)),this._vuwMap[e]=a,this.isFunction(s)&&s.call(a),this):(csl.warn.red(this.name+".add() ... arguments[0] is must be string.",typeof e),this)},get:function(t){var e,i,s=!1;if(!this.isString(t))return csl.warn(this.name+".get() ... arguments[0] is must be string.",typeof t),s;if(s=this._vuwMap[t]||!1,!s&&/\./.test(t))for(i=t.split("."),s=this._vuwMap[i.pop()]||!1,e=i.length-1;e>=0&&s;e--){if(!s._vuwMap){s=!1;break}s=s._vuwMap[i[e]]||!1}return s},getChildren:function(){var e=Object.keys(this._vuwMap).map(function(t){return this[t]},this._vuwMap);return e.get=function(e){return t.isNumber(e)?this[e]||!1:this},e},find:function(e){var s=[];return this.getChildren().forEach(function(t){t.name===e&&s.push(t),s=s.concat(i.find.call(t,e))},this),s.get=function(e){return t.isNumber(e)?this[e]||!1:this},s},remove:function(t){var e;return this.isString(t)?(e=this.get(t))?(e.$self&&e.$self.length&&e.$self.remove(),e.$template&&e.$template.length&&e.$template.remove(),e.isRemoved=!0,delete this._vuwMap[t],this):this:(csl.warn(this.name+".remove() ... arguments[0] is must be string.",typeof t),this)},appendKlass:function(e,i,s){if(!this.isString(e))return csl.warn.red(this.name+".appendKlass() ... arguments[0] is must be string.",typeof e),this;if(t(e))return csl.warn.red(this.name+".appendKlass() ... '"+e+"' is already defined."),this;if(this.isString(s)){if(!this.isFunction(t(s)))return csl.warn(this.name+".appendKlass() ... '"+s+"' is undefined."),this}else{if(!this.isFunction(t(this.childKlass)))return csl.warn(this.name+".appendKlass() ... '"+this.childKlass+"' is undefined."),this;s=this.childKlass}return t.create(e).extends_(s,i),this}});return i.appendKlass("VuwerComponent",{childKlass:"VuwerComponent",_initialize:function(e){return t("VuwerComponent").parent._initialize.call(this,e)?this.childKlass?this.isString(this.childKlass)&&t(this.childKlass)?(this._vuwMap={},this.onReady(i._getComponentsReady.bind(this)),this):(csl.warn("VuwerComponent._initialize() ... 'childKlass' is must be Klass."),!1):(csl.warn("VuwerComponent._initialize() ... 'childKlass' is required prop."),!1):!1},add:function(){return i.add.apply(this,this.getAsArray(arguments)),this},get:function(t){return i.get.call(this,t)},getChildren:function(){return i.getChildren.call(this)},find:function(t){return i.find.call(this,t)},remove:function(t){var e=this.get(t);return e&&(e.getChildren().forEach(function(t){this.remove(t.name)},e),i.remove.call(this,t)),this},getOther:function(t){return this.container.get(t)},getAddress:function(){var t=arguments.length?arguments[0]:[];return t.push(this.name),this.container&&this.container.getAddress?this.container.getAddress(t):t.join(".")},getCloneFromTemplate:function(){var i=this,s=t("Vuw").prototype.getCloneFromTemplate.call(this);return s&&s.find("[data-vuw]").each(function(){var a,t=e(this),s=t.data("vuw"),n=i.get(s);n&&(n.setProp("$self",t,!0),a=i.getState(s),i.isObject(a)&&n.setState(a))}),s}},"Vuw").appendKlass("VuwFade",{_initialize:function(i){return t("VuwFade").parent._initialize.call(this,i)?(this.onReady(function(t){var e;t&&(["absolute","fixed"].indexOf(t.css("position"))>=0&&(this.orgHeight=t.height()),t.addClass("vuw-fade").attr("data-visible",t.attr("data-visible")||"0"),e=parseFloat(t.css("transition-duration")),isNaN(e)?t.css("transition-duration",String(this.delay/1e3)+"s"):this.delay+=1e3*e)}),this.onChangeState(function(t){var i=!!t.visible;return i!==this.state.visible?this.$self?e.Deferred(function(t){return!!this.orgHeight&&this.$self.css("height",this.orgHeight),this.$self.attr("data-visible",i?"1":""),setTimeout(function(){i||this.$self.attr("data-visible","0"),!!this.orgHeight&&this.$self.css("height",""),t.resolve()}.bind(this),this.delay),t.promise()}.bind(this)):(csl.log.red("  "+this.name+".onChangeState","$self is false."),!1):void 0}),this):!1},delay:0},"VuwerComponent"),csl.log.gray("** vuwer (Vuw version:"+t("Vuw").getVersion()+") **"),i}()});