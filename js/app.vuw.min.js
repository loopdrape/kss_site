!function(e){"use strict";return app&&Vuw?void(app.vuwer=Vuw.useVuwer().setProp({_positionTrackings:[],positionTracking:function(t){t.$pt=e("<div/>").addClass("position-tracker").insertBefore(t.$self),t.state.fixStart=parseInt(t.$self.data("fix")),t.onChangeState(function(e){app.isNumber(e.current)&&(e.isFixed=e.current>=e.fixStart&&e.current<=(e.fixEnd||0),this.$self.toggleClass("is-fixed",e.isFixed),delete e.current)}),this._positionTrackings.push(t.name)},updPtFixEnd:function(e,t){var i=this.get(e);return i.isReady?i.setState("fixEnd",i.$pt.offset().top-t):void 0},onScroll:function(e,t){var i=this.get(e);return i.isReady?i.setState("current",t):void 0},onReady:function(t){t.on("resize",function(t,i){var s=e(this),o=e.data(this,"vuw"),a=s.height();!!o._resizeTimer&&clearTimeout(o._resizeTimer),o._resizeTimer=setTimeout(function(){o._positionTrackings.forEach(function(e){this.updPtFixEnd(e,a)},o)},i?0:100)}).on("scroll",function(){var t=e(this),i=e.data(this,"vuw"),s=t.scrollTop();i._positionTrackings.forEach(function(e){this.onScroll(e,s)},i),!!i._scrollTimer&&clearTimeout(i._scrollTimer),i._scrollTimer=setTimeout(function(){app.setScroll(s+10)},100)})}}).add("body",{selector:function(){return e(document.body)},onReady:function(e){app.pageType=[],e.hasClass("page-index")&&app.pageType.push("index"),e.hasClass("page-day")&&app.pageType.push("day"),e.hasClass("page-tag")&&app.pageType.push("tag"),e.hasClass("page-search")&&app.pageType.push("search"),e.hasClass("page-permalink")&&app.pageType.push("permalink"),app.pageType.length&&("index"===app.pageType[0]&&1===app.pageType.length?(app.pageType.push("top"),e.addClass("page-top"),app.isTop=!0):app.isTop=!1),app.pageType=app.pageType.join("."),this._addDeviceInfoClass()._initSmoothScroll()._attachHoverStatus()._attachLink4SP()},_addDeviceInfoClass:function(){var e=[];return e.push("device-"+app.device[0]),app.device.length>1&&e.push("os-"+app.device[1]),e.push("browser-"+app.browser[0]),app.browser.length>1&&e.push(app.browser.join("")),this.$self.addClass(e.join(" ")),this},_initSmoothScroll:function(){return this.$self.on("click","a",function(t){var i,s,o=this.origin;!o&&(o=this.protocol?this.protocol+"//"+this.hostname:""),!this.hash||o+this.pathname!==app.URL&&o||(t.preventDefault(),i=e.data(t.delegateTarget,"vuw"),s=e(this.hash),e("html, body").animate({scrollTop:s.offset().top-20},{complete:app.isFunction(i.smoothScrollCallBack)?function(){!!i._smoothScrollTimer&&clearTimeout(i._smoothScrollTimer),i._smoothScrollTimer=setTimeout(i.smoothScrollCallBack.bind(s),100)}:null,duration:600}))}),this},smoothScrollCallBack:function(){csl.log("scrolled.",this.offset().top)},_attachHoverStatus:function(){return this.getVuwer().$window.on("pageshow",function(){e(".is-hover").removeClass("is-hover")}),this.hoverDecayTime="sp"===app.device[0]?250:0,this.$self.on("mouseenter touchstart","a:not(.btn), .btn, .hoverTarget",function(){e(this).addClass("is-hover")}).on("mouseleave touchend","a:not(.btn), .btn, .hoverTarget",function(t){var i=e.data(t.delegateTarget,"vuw");setTimeout(e.fn.removeClass.bind(e(this),"is-hover"),i.hoverDecayTime)}),this},_attachLink4SP:function(){return this.$self.on("click",".link4SP",function(){var t=e(this),i={href:t.data("href"),blank:"_blank"===t.data("target")?!0:!1};"sp"===app.device[0]&&(i.blank?window.open(i.href):location.href=i.href)}),this},onChangeState:function(e){"boolean"==typeof e.lockScroll&&this.$self.toggleClass("is-lock-scroll",e.lockScroll)}}).add("siteHeader",{selector:"#site_header",onReady:function(t){t.on("click",".icon-keeshkas",function(t){var i=e.data(t.delegateTarget,"vuw");t.preventDefault(),i.getOther("nav").getState("isFixed")?i.getOther("switchNavLinks").$self.trigger("click",[!0]):i.getOther("scrollToPageTop").execScroll()})}}).add("siteBody",{selector:"#site_body",onReady:function(){},onChangeState:function(e){this.$self.attr({"data-view":e.view||""})}}).add("siteFooter",{selector:"#site_footer",onReady:function(){},fixBottom:function(){var e=this;return this.$wrap=this.$self.parent(),!!this.$wrap.length&&(this.$wrap=this.$wrap.eq(0)),"static"===this.$wrap.css("position")&&this.$wrap.css("position","relative"),this.$wrap.isBorderBox="border-box"===this.$wrap.css("box-sizing")?!0:!1,this.updStyle=function(){var e={"min-height":this.getVuwer().$window.outerHeight()-1,"padding-bottom":this.$self.outerHeight(!0)};return this.$wrap.isBorderBox||(e["min-height"]-=e["padding-bottom"]),this.$wrap.css(e),this},this.updStyle(),this.getVuwer().$window.on("resize",function(t,i){e._fixTimer&&clearTimeout(e._fixTimer),e._fixTimer=setTimeout(e.updStyle.bind(e),i?0:50)}),this.$self.css({position:"absolute",bottom:0,left:0}).addClass("fixed-bottom"),this}}).add("nav",{selector:"#site_nav",onReady:function(){this.getVuwer().positionTracking(this)},onChangeState:function(e){this.$self.toggleClass("lock-fixed",!!e.isLockFixed)}}).add("switchNavLinks",{selector:"#show_nav_links",onReady:function(t){this.$link=t.closest(".btn-toggle"),t.on("change",function(t,i){var s=e.data(this,"vuw"),o=app.isString(i)?i:"posts";s.setState("isChecked",this.checked),s.getOther("nav").setState("isLockFixed",this.checked),s.getOther("siteBody").setState("view",this.checked?"":o)})},onChangeState:function(e){this.$link.toggleClass("is-checked",!!e.isChecked)}}).add("searchBox",{selector:"#search_box",onReady:function(t){t.on("focus",".inp-txt",function(t){var i=e.data(t.delegateTarget,"vuw");i.setState("focus",!0)}).on("blur",".inp-txt",function(t){var i=e.data(t.delegateTarget,"vuw");i.setState("focus",!1)}),this.$inp=e("#inp_q"),this.getOther("nav").onChangeState(function(e){this.getOther("searchBox").setState("rockOpen",!!e.isFixed)}),this.state.focus=!1},onChangeState:function(e){this.$self.toggleClass("is-focus",e.focus).toggleClass("is-rockOpen",e.rockOpen).closest(".link-list").toggleClass("is-form-focus",e.focus)}}).add("btnSearch",{selector:function(){return this.getOther("searchBox").$self.find(".btn-search")},onReady:function(){this.state.htmlFor=this.$self.attr("for"),this.getOther("searchBox").onChangeState(function(e){var t;t=e.rockOpen?"search_submit":e.focus?"search_submit":"inp_q",this.getOther("btnSearch").setState({htmlFor:t})}),this.$self.on("click",function(t){var i=e.data(this,"vuw");"inp_q"===i.getState("htmlFor")&&(t.preventDefault(),i.getOther("searchBox").$inp.trigger("focus",[!0]))})},onChangeState:function(){}}).add("scrollToPageTop",{selector:"#scroll_to_pageTop",onReady:function(){this.getVuwer().positionTracking(this)},execScroll:function(){this.$self.children(".btn-exec").trigger("click",[!0])}}).add("secTitle",{selector:"#sec_title",onReady:function(t){var i;i=[],i.push(e.Deferred(function(t){return e("#main_bg_video").on("load",t.resolve),setTimeout(t.resolve,1e3),t.promise()})),i.push(e.Deferred(function(t){return e("#main_bg_image").on("load",t.resolve),setTimeout(t.resolve,1e3),t.promise()})),e.when.apply(e,i).then(function(){csl.log("main bg loaded"),this.getVuwer().$window.trigger("resize",[!0])}.bind(this)),this.$title=t.children(".main-title"),app.isTop&&(this.getOther("body").onChangeState(function(e){e.wndH&&e.ttlH&&(e.t=.6*e.wndH<e.ttlH?e.ttlH:"",csl.log("body.onChangeState",e),this.$self.css("padding-top",e.t),delete e.t)}),this.$mainBG=t.children(".main-background"),this.getVuwer().$window.on("resize",function(t,i){var s=e.data(this,"vuw"),o=s.get("secTitle");!!o._timer&&clearTimeout(o._timer),o._timer=setTimeout(function(){s.get("body").setState({wndH:s.$window.height(),ttlH:o.$mainBG.height()})},i?0:100)}))},onChangeState:function(e){"anime"in e&&this.$title.toggleClass("is-anime",!!e.anime)}}).add("secDescription",{selector:"#sec_description",onReady:function(t){this._delay=1e3*parseFloat(t.css("transition-duration")),t.on("click",".btn-close",function(t){t.preventDefault();var i=e.data(t.delegateTarget,"vuw");i.getOther("siteBody").setState("view","").then(function(){var t=e.Deferred();return setTimeout(t.resolve,this._delay),t.promise()}.bind(this)).then(function(){i.getOther("siteBody").setState("view","posts")})})}}).add("showDescription",{selector:"#show_description",onReady:function(t){t.on("click",function(t){t.preventDefault();var i=e.data(t.delegateTarget,"vuw");i.getOther("switchNavLinks").$self.prop({checked:!1}).trigger("change",["description"])})}}).add("posts",{selector:"#posts",checkLoaded:function(){var t=[];return this.$self.find("img, iframe, video").each(function(){var i=e(this);t.push(e.Deferred(function(t){return e.data(i.get(0),"timer",setTimeout(function(){i.off(".check"),t.resolve()},1e3)),i.on("load.check",function(){clearTimeout(e.data(this,"timer")),t.resolve()}),t.promise()}))}),e.when.apply(e,t).then(function(){csl.log("checkLoaded","complete")})},addLoadListener:function(t,i){t&&t.length&app.isFunction(i)&&e.Deferred(function(e){return t.eq(0).on("load",e.resolve),setTimeout(e.resolve,1e3),e.promise()}).then(function(){i.call(t.get(0))})},scMap:{},postCheck:function(t){var i=this,s=t.attr("id");switch(t.data("type")){case"audio":t.hasClass("soundcloud")&&window.SC&&this.addLoadListener(t.find("iframe"),function(){window.SC.Widget(this).getCurrentSound(function(o){e("<img/>").addClass("thumbnail").attr({src:o.artwork_url.replace("-large","-t500x500"),alt:"artwork"}).appendTo(t),i.scMap[s]=o,csl.log("soundcloud",s,o)})})}},onReady:function(t){var i=this;/^index/.test(app.pageType)&&(i.$posts=t.children(".post").each(function(){i.postCheck(e(this))}),/\.top/.test(app.pageType)&&i.$posts.eq(5).before(e("<div/>").addClass("post more-box").append(e("<a/>").addClass("icon-more-after").append(e("<span/>").text("more")))))}})):!1}(window.jQuery||window.$);