!function(t){"use strict";return window.app&&app.Vue?(function(){app.useVuer(),app.vuer.add("window",{selector:function(){return t(window)},onReady:function(){}}).add("body",{selector:function(){return t(document.body)},onReady:function(t){app.isTop=function(t){return t.indexOf("page-day")<=0&&t.indexOf("page-tag")<=0&&t.indexOf("page-search")<=0&&t.indexOf("page-permalink")<=0}(t.get(0).className.split(" ")),app.isTop&&t.addClass("page-top"),this._addDeviceInfoClass()._initSmoothScroll(t)._attachHoverStatus(t)._attachLink4SP(t)},_addDeviceInfoClass:function(){var t=[];return t.push("device-"+app.device[0]),app.device.length>1&&t.push("os-"+app.device[1]),t.push("browser-"+app.browser[0]),app.browser.length>1&&t.push(app.browser.join("")),this.$self.addClass(t.join(" ")),this},_initSmoothScroll:function(e){var i=this;return e.on("click","a",function(e){var a;this.hash&&this.origin+this.pathname===app.URL&&(e.preventDefault(),a=t(this.hash),t("html, body").animate({scrollTop:a.offset().top-20},{complete:app.isFunction(i.smoothScrollCallBack)?function(){i._smoothScrollTimer&&clearTimeout(i._smoothScrollTimer),i._smoothScrollTimer=setTimeout(i.smoothScrollCallBack.bind(a),100)}:null,duration:600}))}),this},smoothScrollCallBack:function(){app.cnLog("scrolled.",this.offset().top)},_attachHoverStatus:function(e){var i=this;return i.getOther("window").$self.on("pageshow",function(){t(".is-hover").removeClass("is-hover")}),i.hoverDecayTime="sp"===app.device[0]?250:0,e.on("mouseenter touchstart","a:not(.btn), .btn, .hoverTarget",function(){t(this).addClass("is-hover")}).on("mouseleave touchend","a:not(.btn), .btn, .hoverTarget",function(){setTimeout(t.fn.removeClass.bind(t(this),"is-hover"),i.hoverDecayTime)}),this},_attachLink4SP:function(e){return e.on("click",".link4SP",function(){var e=t(this),i={href:e.data("href"),blank:"_blank"===e.data("target")?!0:!1};"sp"===app.device[0]&&(i.blank?window.open(i.href):location.href=i.href)}),this}}).add("siteHeader",{selector:"#site_header",onReady:function(e){e.on("click",".icon-keeshkas",function(e){e.preventDefault();var i=t.data(this,"target");i||(i=t("#show_nav_links"),t.data(this,"target",i)),i.trigger("click",[!0])})}}).add("siteBody",{selector:"#site_body",onReady:function(){}}).add("siteFooter",{selector:"#site_footer",onReady:function(){},fixBottom:function(){var t=this;return this.$wrap=this.$self.parent(),this.$wrap.length>1&&(this.$wrap=this.$wrap.eq(0)),"static"===this.$wrap.css("position")&&this.$wrap.css("position","relative"),this.$wrap.isBorderBox="border-box"===this.$wrap.css("box-sizing")?!0:!1,this.updStyle=function(){var t={"min-height":this.getOther("window").$self.outerHeight()-1,"padding-bottom":this.$self.outerHeight(!0)};return this.$wrap.isBorderBox||(t["min-height"]-=t["padding-bottom"]),this.$wrap.css(t),this},this.updStyle(),this.getOther("window").$self.on("resize",function(){t._fixTimer&&clearTimeout(t._fixTimer),t._fixTimer=setTimeout(t.updStyle.bind(t),100)}),this.$self.css({position:"absolute",bottom:0,left:0}).addClass("fixed-bottom"),this}}).add("searchBox",{selector:"#search_box",onReady:function(e){e.find("input").on("focus",function(e){var i=t.data(e.delegateTarget,"vue");i.setState("focus",!0)}).on("blur",function(e){var i=t.data(e.delegateTarget,"vue");i.setState("focus",!1)})},render:function(){return this.$self.toggleClass("is-focus",this.getState("focus"))}}).add("nav",{selector:"#site_nav",onReady:function(e){var i=t("<div/>").addClass("position-tracker").insertBefore(e);e.data("pt",i),this.getOther("window").$self.on("resize",function(){var i=e.data("pt");e.data({fixEnd:i.offset().top-t(this).height()})}).on("scroll",function(){var i={fStart:e.data("fix"),fEnd:e.data("fixEnd")};"number"==typeof i.fStart||(i.fStart=parseInt(i.fStart)),"number"==typeof i.fEnd||(i.fEnd=parseInt(i.fEnd)),i.current=t(this).scrollTop(),i.isFixed=i.current>=i.fStart&&i.current<=i.fEnd,e.toggleClass("is-fixed",i.isFixed)})}}).add("scrollToPageTop",{selector:"#scroll_to_pageTop",onReady:function(e){var i=t("<div/>").addClass("position-tracker").insertBefore(e);e.data("pt",i),this.getOther("window").$self.on("resize",function(){var i=e.data("pt");e.data({fixEnd:i.offset().top-t(this).height()})}).on("scroll",function(){var i={fStart:e.data("fix"),fEnd:e.data("fixEnd")};"number"==typeof i.fStart||(i.fStart=parseInt(i.fStart)),"number"==typeof i.fEnd||(i.fEnd=parseInt(i.fEnd)),i.current=t(this).scrollTop(),i.isFixed=i.current>=i.fStart&&i.current<=i.fEnd,e.toggleClass("is-fixed",i.isFixed)}).trigger("scroll")}}).add("pageLoader",{selector:"#page_loader",delay:1,onReady:function(t){var e;t&&(t.attr("data-visible","0").removeClass("hide"),e=parseFloat(t.css("transition-duration")),isNaN(e)||(this.delay+=1e3*e),("ie"!==app.browser[0]||app.browser[1]>9)&&t.cssLoader())},show:function(t){return this.$self?(app.isFunction(t)||(t=function(){}),this.$self.attr("data-visible",""),setTimeout(function(){this.$self.attr("data-visible","1"),setTimeout(t.bind(this),this.delay)}.bind(this),0)):(app.cnWarn("pageLoader.show","$self is false."),t.call(this)),this},hide:function(t){return this.$self?(app.isFunction(t)||(t=function(){}),this.$self.attr("data-visible",""),setTimeout(function(){this.$self.attr("data-visible","0"),t.call(this)}.bind(this),this.delay)):(app.cnWarn("pageLoader.hide","$self is false."),t.call(this)),this}})}(),app.pushState=function(t,e){return window.WebAppBase.prototype.pushState.call(app,t,e)?(!!window.ga&&function(t){t("set","page",e),t("send","pageview"),app.cnLog("**** send ga pageview.",e)}(window.ga),this):!1},app.replaceState=function(t,e){return window.WebAppBase.prototype.replaceState.call(app,t,e)?(!!window.ga&&function(t){t("set","page",e),t("send","pageview"),app.cnLog("**** send ga pageview.",e)}(window.ga),this):!1},app.exec(function(){return app.vuer.getReady()}).then(function(){app.vuer.get("body").$self.addClass("is-ready"),setTimeout(function(){app.vuer.get("siteFooter").fixBottom(),app.cnLog("app ready.")},0)}),app.showLoading=function(e){var i=t.Deferred(),a=app.vuer.get("pageLoader");return a&&app.isString(e)?t.when(a.isReady?!1:a.getReady()).then(function(){a._loadingBy?(app.cnLog("  (kick showLoading "+e+")"),i.resolve()):(a._loadingBy=e,a.show(function(){app.cnLog("showLoading",[this._loadingBy]),i.resolve()}))}.bind(this)):i.resolve(),i.promise()},app.hideLoading=function(e){var i=t.Deferred(),a=app.vuer.get("pageLoader");return a&&app.isString(e)?a._loadingBy===e?a.hide(function(){app.cnLog("hideLoading",[e]),delete this._loadingBy,i.resolve()}):(app.cnLog("  (kick hideLoading "+e+")"),i.resolve()):i.resolve(),i.promise()},void(app.cleanupAfterWriteHTML=function(e){var i=e instanceof t?e:t(e);return i.length?(i.children("script").remove(),i.find("a").each(function(){this.href===app.URL&&t(this).addClass("is-current")}),i):!1})):!1}(window.jQuery||window.$);