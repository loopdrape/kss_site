!function(e){"use strict";return app&&Klass("Vuw")?(e.Deferred(function(t){return e(function(){vuwer.getReady().then(t.resolve)}),t.promise()}).then(function(){var t=Array.prototype.slice.call(arguments,0);return csl.log.blue("vuwer ready.",t),e.when(app.showLoading(),e.when.apply(e,app._execCallbacks.map(function(e){return e.apply(this,t)},app)))}).then(function(){var t=e.Deferred();return vuwer.get("body").$self.addClass("is-ready"),vuwer.$window.trigger("resize",[!0]),setTimeout(t.resolve,600),t.promise()}).then(function(){return app.hideLoading()}).then(function(){vuwer.$window.trigger("scroll",[!0]),csl.log.blue("**** app ready. ****")}),app.positionTracking={_targets:[],add:function(t){if(!(t instanceof Klass("Vuw")))throw new TypeError("arguments[0] must be Vuw instance.");t.$pt=e("<div/>").addClass("position-tracker").insertBefore(t.$self),t.state.fixStart=parseInt(t.$self.data("fix")),t.onChangeState(function(e){var t;return this.isNumber(e.current)?(t=e.current>=e.fixStart&&e.current<=(e.fixEnd||0),e.isFixed!==t&&(this.$self.toggleClass("is-fixed",t),this.$pt.css({height:t?this.height:""}),e.isFixed=t),void delete e.current):!1}),this._targets.push(t.getAddress())},updFixEnd:function(t){var i=this._targets.map(function(e){var i=vuwer.get(e);return i.isReady?(i.height=i.$self.outerHeight(),i.setState("fixEnd",i.$pt.offset().top-t)):void 0});return e.when.apply(e,i)},onScroll:function(t){var i=this._targets.map(function(e){var i=vuwer.get(e);return i.isReady?i.setState("current",t):void 0});return e.when.apply(e,i)}},vuwer.onReady(function(e){e.on("resize.pt",function(t,i){!!vuwer._resizePtTimer&&clearTimeout(vuwer._resizePtTimer),vuwer._resizePtTimer=setTimeout(function(){app.positionTracking.updFixEnd(e.height())},i?0:100)}).on("scroll.pt",function(){!!vuwer._scrollPtTimer&&clearTimeout(vuwer._scrollPtTimer),vuwer._scrollPtTimer=setTimeout(function(){app.positionTracking.onScroll(e.scrollTop())},0)})}),app._execCallbacks=[],app.onReady=function(e){this.isFunction(e)&&this._execCallbacks.push(e)},app.showLoading=function(){return vuwer.get("secTitle").setState("anime",!0)},app.hideLoading=function(){return vuwer.get("secTitle").setState("anime",!1)},app.pushState=function(e,t){return Klass("WebAppBase").prototype.pushState.call(app,e,t)?(!!window.ga&&function(e){e("set","page",t),e("send","pageview"),csl.log.gray("**** send ga pageview.",t)}(window.ga),this):!1},void(app.replaceState=function(e,t){return Klass("WebAppBase").prototype.replaceState.call(app,e,t)?(!!window.ga&&function(e){e("set","page",t),e("send","pageview"),csl.log.gray("**** send ga pageview.",t)}(window.ga),this):!1})):!1}(window.jQuery||window.$);