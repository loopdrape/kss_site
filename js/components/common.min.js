!function(e,t){"use strict";t(e.Klass,e.app,e.vuwer,e.jQuery||e.$)}(this,function(e,t,i,s){"use strict";i.setProp({onReady:function(e){e.on("popstate",function(e){var s=e.originalEvent.state;t.isObject(s)||(s={}),csl.log.blue("** popstate **",s),s.isPopstate=!0,i.setState(s)})},onChangeState:function(e){var o,i=!!e.isPopstate,a=[],n={};return i&&delete e.isPopstate,t._GET=this.isString(e.query)?t.parseQueryString(e.query):{},n.body={},n.contentsView={},"post"===e.param?(n.body.page="permalink",n.contentsView.view="posts",n.contentsView.active=e.value):(n.body.page="index","tagged"===e.param&&a.push(e.value===this.state.value?t.posts.loadPosts(e.pathname):t.posts.replacePosts(e.pathname))),t._GET.description&&(n.body.page="permalink",n.contentsView.view="description"),a=a.concat(Object.keys(n).map(function(e){return this.get(e).setState(n[e])},this)),(e.pathname!==this.state.pathname||e.query!==this.state.query)&&(o=(e.pathname||"/")+(e.query||""),t[i?"replaceState":"pushState"](e,location.origin+o,{title:(e.title?e.title+" // ":"")+t.config.siteTitle})),csl.log.orange("vuwer:change",e,n,a.length),s.when.apply(s,a)},changePathname:function(e,t){var i,s;return this.isString(e)||(e=""),e=e.replace(/^\//,""),this.isString(t)||(t=""),i=e.split("/"),s={pathname:"/"+e,param:i.shift()||""},!!t&&(s.query=t),s.param&&(s.value=i.shift()||"",i.length&&(s.title=i.join(" / "))),this.setState(s)}}).add("body",{selector:function(){return s(document.body)},onReady:function(e){t.pageType=[],e.hasClass("page-index")&&t.pageType.push("index"),e.hasClass("page-day")&&t.pageType.push("day"),e.hasClass("page-tag")&&t.pageType.push("tag"),e.hasClass("page-search")&&t.pageType.push("search"),e.hasClass("page-permalink")&&t.pageType.push("permalink"),t.pageType.length&&("index"===t.pageType[0]&&1===t.pageType.length?(t.pageType.push("top"),e.addClass("page-top"),t.isTop=!0):t.isTop=!1),t.pageType=t.pageType.join("."),this._addDeviceInfoClass()._initSmoothScroll()._attachHoverStatus()._attachLink4SP()},_addDeviceInfoClass:function(){var e=[];return e.push("device-"+t.device[0]),t.device.length>1&&e.push("os-"+t.device[1]),e.push("browser-"+t.browser[0]),t.browser.length>1&&e.push(t.browser.join("")),this.$self.addClass(e.join(" ")),this},_initSmoothScroll:function(){return this.$self.on("click","a",function(e){var i,a,n=this.origin;!n&&(n=this.protocol?this.protocol+"//"+this.hostname:""),!this.hash||n+this.pathname!==t.URL&&n||(e.preventDefault(),i=s.data(e.delegateTarget,"vuw"),a=s(this.hash),s("html, body").animate({scrollTop:a.offset().top-20},{complete:t.isFunction(i.smoothScrollCallBack)?function(){!!i._smoothScrollTimer&&clearTimeout(i._smoothScrollTimer),i._smoothScrollTimer=setTimeout(i.smoothScrollCallBack.bind(a),100)}:null,duration:600}))}),this},smoothScrollCallBack:function(){csl.log("scrolled.",this.offset().top)},_attachHoverStatus:function(){return i.$window.on("pageshow",function(){s(".is-hover").removeClass("is-hover")}),this.hoverDecayTime="sp"===t.device[0]?250:0,this.$self.on("mouseenter touchstart","a, .hoverTarget",function(){s(this).addClass("is-hover")}).on("mouseleave touchend","a, .hoverTarget",function(e){var t=s.data(e.delegateTarget,"vuw");setTimeout(s.fn.removeClass.bind(s(this),"is-hover"),t.hoverDecayTime)}),this},_attachLink4SP:function(){return this.$self.on("click",".link4SP",function(){var e=s(this),i={href:e.data("href"),blank:"_blank"===e.data("target")?!0:!1};"sp"===t.device[0]&&(i.blank?window.open(i.href):location.href=i.href)}),this},onChangeState:function(e){"boolean"==typeof e.lockScroll&&this.$self.toggleClass("is-lock-scroll",e.lockScroll),e.page!==this.state.page&&this.$self.attr("data-page",e.page||"index")}}).add("siteHeader",{selector:"#site_header",onReady:function(e){this.$title=e.children(".site-title")},onChangeState:function(e){"anime"in e&&(this.$title.toggleClass("is-anime",!!e.anime),delete e.anime)}}).add("siteBody",{selector:"#site_body"}).add("scrollToPageTop",{selector:"#scroll_to_pageTop",onReady:function(){t.positionTracker.tracking(this,!0,!0)},execScroll:function(){this.$self.children(".btn-exec").trigger("click",[!0])}}).add("siteFooter",{selector:"#site_footer",onReady:function(){},fixBottom:function(){var e=this;return this.$wrap=this.$self.parent(),!!this.$wrap.length&&(this.$wrap=this.$wrap.eq(0)),"static"===this.$wrap.css("position")&&this.$wrap.css("position","relative"),this.$wrap.isBorderBox="border-box"===this.$wrap.css("box-sizing")?!0:!1,this.updStyle=function(){var e={"min-height":i.$window.outerHeight()-1,"padding-bottom":this.$self.outerHeight(!0)};return this.$wrap.isBorderBox||(e["min-height"]-=e["padding-bottom"]),this.$wrap.css(e),this},this.updStyle(),i.$window.on("resize",function(t,i){e._fixTimer&&clearTimeout(e._fixTimer),e._fixTimer=setTimeout(e.updStyle.bind(e),i?0:50)}),this.$self.css({position:"absolute",bottom:0,left:0}).addClass("fixed-bottom"),this}})});