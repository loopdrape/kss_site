!function(e,t){"use strict";t(e.SC,e.Klass,e.app,e.vuwer,e.jQuery||e.$)}(this,function(e,t,n,i,a){"use strict";i.get("siteBody").add("thumbList",{selector:"#thumb_list",onReady:function(e){!!e&&e.on("click",".permalink",function(e){e.preventDefault(),a(this).toggleClass("is-active"),i.changePathname(this.className.indexOf("is-active")<0?"/":this.pathname)})},onChangeState:function(e){var t;return this.$self&&this.isArray(e.items)&&e.items.length?(csl.log.orange(this.name+": new items",e.items.length),t=[],e.items.forEach(function(e){var n=e.attr("id"),i=a("<li/>").attr({id:n.replace(/^post/,"thumb"),"data-id":n}).addClass(e.get(0).className.replace(/^post /,"")),s=e.children(".permalink").appendTo(i),r=a("<span/>").addClass("img-frame").appendTo(s),l=e.find(".entry-title").clone();l.children(".date").replaceWith(function(){return a(this).children().addClass(this.className)}),l.children(".date").next().length||l.append(a("<span/>").html(s.attr("href").split("/").pop())),l.children().appendTo(s),e.onInnerLoad(this._createThumbnail.bind(this,e,function(e){e.appendTo(r),csl.log.gray("thumbnail: "+n)})),t.push(i)},this),void(!!t.length&&a.fn.append.apply(this.$self,t))):!1},_createThumbnail:function(n,i){n.attr("id");return a.Deferred(function(t){var i;return"audio"===n.data("type")&&n.hasClass("soundcloud")?e?(i=n.find("iframe"),i.length?e.Widget(i.get(0)).getCurrentSound(function(e){t.resolve(e.artwork_url.replace("-large","-t500x500"))}):t.reject()):t.reject():(i=n.find("img").eq(0),i.hasClass("thumbnail")&&i.remove(),i.length?t.resolve(i.attr("src")):t.reject()),t.promise()}).then(function(e){var n=a("<img/>").attr({src:e,alt:"thumbnail"});t.isFunction(i)&&i(n)},function(){})},addItems:function(e){return this.setState({items:e})},clearItems:function(){return!!this.$self&&this.$self.empty(),this}},function(){n.thumbs=this})});